  <!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <title> Watch DRM-Protected Content on Debian Jessie &middot; Mehdi Sadeghi </title>
    
    <link rel="stylesheet" type="text/css" href="http://mehdisadeghi.me//css/uno.min.css" />
    <link rel="stylesheet" type="text/css" href="http://mehdisadeghi.me//css/lightGallery.css" />
    
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.ico">
    
    <link href="" rel="alternate" type="application/rss+xml" title="Mehdi Sadeghi" />
    
    <script src="http://mehdisadeghi.me//js/jquery.min.js"></script>
    <script src="http://mehdisadeghi.me//js/main.min.js">
    </script>
</head>

  <body>
    <span class="mobile btn-mobile-menu">
        <i class="fa fa-bars btn-mobile-menu__icon"></i>
        <i class="fa fa-times btn-mobile-close__icon hidden"> </i>
    </span>

<header class="panel-cover panel-cover--collapsed"  id="scriptHeader">
    <div class="panel-main">
        <div class="panel-main__inner panel-inverted">
            <div class="panel-main__content"> 
                <h1 class="panel-cover__title panel-title">
                    <a href="http://mehdisadeghi.me/"  title="link to homepage for Mehdi Sadeghi">Mehdi Sadeghi</a>
                </h1>
                <hr class="panel-cover__divider" />
                <p class="panel-cover__description">  Thoughs of a Digital Citizen  </p>
                <hr class="panel-cover__divider panel-cover__divider--secondary" />
                <div class="navigation-wrapper">
                    <nav class="cover-navigation cover-navigation--primary">
                        <ul class="navigation">
                            <li class="navigation__item"><a href="/#blog" title="link to Mehdi Sadeghi blog" class="blog-button">Blog</a> </li>
                            </br>  </ul>
                    </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation">    </br>    </ul>
</nav>
 </div>
            </div>
        </div>
        <div class="panel-cover--overlay"></div>
    </div>
</header>
<noscript>
    <style>
        #scriptHeader {display:none;}
    </style>

    <header class="panel-cover panel-cover--collapsed" style="background-image: url()">
        <div class="panel-main">
            <div class="panel-main__inner panel-inverted">
                <div class="panel-main__content"> 
                    <h1 class="panel-cover__title panel-title">
                        <a href="http://mehdisadeghi.me/"  title="link to homepage for Mehdi Sadeghi">Mehdi Sadeghi</a>
                    </h1>
                    <hr class="panel-cover__divider" />
                    <p class="panel-cover__description">  Thoughs of a Digital Citizen  </p>
                    <hr class="panel-cover__divider panel-cover__divider--secondary" />
                    <div class="navigation-wrapper">
                        <nav class="cover-navigation cover-navigation--primary">
                            <ul class="navigation">
                                <li class="navigation__item"><a href="/#blog" title="link to Mehdi Sadeghi blog" class="blog-button">Blog</a> </li>
                                </br>  </ul>
                        </nav> <nav class="cover-navigation navigation--social">
    <ul class="navigation">    </br>    </ul>
</nav>
 </div>
                </div>
            </div>
            <div class="panel-cover--overlay"></div>
        </div>
    </header>
</noscript>

    <div class="content-wrapper">
      <div class="content-wrapper__inner">
        <div class="post">
          <h1>Watch DRM-Protected Content on Debian Jessie</h1>
          <span class="post-date">Sun, Jun 14, 2015</span>
          <p>I have recently installed Debian 8.0 (codenamed Jessie) and like many other distros I have to gradually fix problems that I came across. Here is how I managed to watch Amazon&rsquo;s prime videos using Iceweasel.</p>

<p>Trying to watch Amazon&rsquo;s videos which are DRM-protected results in an error pages in Iceweasel on Debian. Flash is installed on my machine but DRM content
on Flash requires HAL to play. The problem is that HAL is deprecated and is not used anymore by major distributions including Debian.</p>

<p>To make it work first I had to install a modified libhub library. This library does not provide full HAL functionality (which I don&rsquo;t need) instead it has the bare minimum to let the Flash to decode the DRM content. This package is called <a href="https://aur.archlinux.org/packages/hal-flash/">hal-flash</a> and is available for <a href="https://github.com/cshorler/hal-flash/archive/v0.3.0.tar.gz">download</a>.</p>

<pre><code>$ tar xzf hal-flash-0.3.0.tar.gz
$ cd hal-flash-0.3.0
</code></pre>

<p>This package has a few dependencies that should be installed first. Please pay attention that I have already installed other build related packages on my machine so you might experience other errors that I did not have.</p>

<pre><code>$ sudo apt-get install dbus udisks2 autoconf git pkgconfig
</code></pre>

<p>At this stage I tried autoconf to generate configure script but it failed. So I found a <a href="https://bbs.archlinux.org/viewtopic.php?pid=1258673#p1258673">workaround</a> which suggests doing the following to have a working configure script.</p>

<pre><code>$ sudo apt-get install pkg-config xorg-server-devel libtool automake
$ libtoolize --force
$ aclocal
$ autoheader
$ automake --force-missing --add-missing
$ autoconf
</code></pre>

<p>At this stage I had a working configure script.</p>

<pre><code>$ ./configure
$ make
</code></pre>

<p>I&rsquo;m used to install compiled source codes with <code>checkinstall</code> script. It let the package manager to track the installed files.</p>

<pre><code>$ sudo apt-get install checkinstall
$ sudo checkinstall make install
</code></pre>

<p>Make sure to change the version number, otherwise the install script will complain that version number can&rsquo;t be a string. If everything goes well we should have the libhal.so installed in system library path.</p>

<pre><code>$ ls -l /usr/local/lib/libhal.so
lrwxrwxrwx 1 root staff 15 Jun 13 11:01 /usr/local/lib/libhal.so -&gt; libhal.so.1.0.0
</code></pre>

<p>Before trying the Amazon videos we need to remove existing Flash files and make sure that the udisks2 service is running.</p>

<pre><code>$ systemctl start udisks2.service
$ systemctl status udisks2.service
● udisks2.service - Disk Manager
   Loaded: loaded (/lib/systemd/system/udisks2.service; static)
   Active: active (running) since Sa 2015-06-13 10:59:43 CEST; 1 day 2h ago
     Docs: man:udisks(8)
 Main PID: 26013 (udisksd)
   CGroup: /system.slice/udisks2.service
           └─26013 /usr/lib/udisks2/udisksd --no-debug
</code></pre>

<p>And removing the files.</p>

<pre><code>$ rm -rf ~/.adobe/Flash_Player/*
</code></pre>

<p>I did a <code>killall iceweasel</code> and after that I was able to watch the videos. I hope it works well for you as well!</p>

<p>At the end I have to give credit to awesome people at Archlinux for their perfect documentations.</p>

        </div>
        

      </div>
    </div>
  </body>
  
</html>
